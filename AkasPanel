-- // CẤU HÌNH
local FOV_RADIUS   = 60            -- Bán kính FOV
local AIM_PART     = "Head"        -- "Head" hoặc "HumanoidRootPart"
local PREDICT      = 0.13          -- Prediction
local SMOOTH       = 0.2           -- Độ mượt camera

-- // SERVICES
local players  = game:GetService("Players")
local run      = game:GetService("RunService")
local camera   = workspace.CurrentCamera

local player   = players.LocalPlayer
local mouse    = player:GetMouse()

-- // VẼ FOV CIRCLE
local fov      = Drawing.new("Circle")
fov.Radius     = FOV_RADIUS
fov.Color      = Color3.fromRGB(255, 255, 255)
fov.Thickness  = 1
fov.NumSides   = 30
fov.Filled     = false
fov.Visible    = true

-- // CẬP NHẬT VỊ TRÍ FOV
run.RenderStepped:Connect(function()
    fov.Position = Vector2.new(mouse.X, mouse.Y + 36)
end)

-- // TÌM NGƯỜI TRONG FOV
local function inFov()
    local maxDist = FOV_RADIUS
    local closest = nil
    for _, p in pairs(players:GetPlayers()) do
        if p ~= player and p.Character and p.Character:FindFirstChild(AIM_PART) and p.Character.Humanoid.Health > 0 then
            local pos, on = camera:WorldToViewportPoint(p.Character[AIM_PART].Position)
            if on then
                local dist = (Vector2.new(pos.X, pos.Y) - fov.Position).Magnitude
                if dist < maxDist then
                    maxDist  = dist
                    closest  = p
                end
            end
        end
    end
    return closest
end

-- // AIMLOCK LOOP
run.RenderStepped:Connect(function()
    local target = inFov()
    if target and target.Character and target.Character:FindFirstChild(AIM_PART) then
        local part  = target.Character[AIM_PART]
        local aimCf = part.CFrame + part.Velocity * PREDICT
        camera.CFrame = camera.CFrame:Lerp(CFrame.lookAt(camera.CFrame.Position, aimCf.Position), SMOOTH)
    end
end)
